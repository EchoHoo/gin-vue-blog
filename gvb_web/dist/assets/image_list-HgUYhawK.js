import{_ as N}from"./gvb_table-G_plVNMz.js";import{a as f}from"./image_api-DsHtMJDt.js";import{b as R,c as _,r as b,d as v,f as i,w as a,g as y,h as n,o as g,s as B,e as r,i as k,l as E}from"./index-Csyz-WVi.js";import"./data-DE6nU9bg.js";const T=r("i",{class:"fa fa-cloud-upload"},null,-1),$=r("div",{style:{"margin-left":"5px"}},"上传图片",-1),O=["src"],S=["src"],D={__name:"image_list",setup(q){const x=R(),d=_(null),h=_(null),t=b({columns:[{title:"id",key:"id",dataIndex:"id"},{title:"图片名称",key:"name",dataIndex:"name"},{title:"图片",key:"path",dataIndex:"path"},{title:"类型",key:"image_type",dataIndex:"image_type"},{title:"上传时间",key:"created_at",dataIndex:"created_at"},{title:"操作",key:"action",dataIndex:"action"}],modalVisible:!1,visible:!1}),o=b({id:0,name:"",path:""});function V(s){t.modalVisible=!0,o.id=s.id,o.name=s.name,o.path=s.path}async function C(){try{let s=await f(o);if(s.code){y.error(s.msg);return}y.success(s.msg),t.modalVisible=!1,d.value.ExportList()}catch{}f(o)}function I(){t.visible=!1,d.value.ExportList()}return(s,l)=>{const L=n("a-upload"),m=n("a-modal"),U=n("a-input"),p=n("a-form-item"),w=n("a-form"),u=n("a-button");return g(),v("div",null,[i(m,{title:"上传图片",visible:t.visible,"onUpdate:visible":l[1]||(l[1]=e=>t.visible=e),onOk:I},{default:a(()=>[i(L,{"file-list":t.fileList,"onUpdate:fileList":l[0]||(l[0]=e=>t.fileList=e),action:"/api/images","list-type":"picture-card",name:"images",multiple:"",headers:{token:B(x).userInfo.token}},{default:a(()=>[T,$]),_:1},8,["file-list","headers"])]),_:1},8,["visible"]),i(m,{title:"编辑图片",visible:t.modalVisible,"onUpdate:visible":l[3]||(l[3]=e=>t.modalVisible=e),onOk:C},{default:a(()=>[i(w,{model:o,name:"basic","label-col":{span:4},"wrapper-col":{span:16},ref_key:"formRef",ref:h,autocomplete:"off"},{default:a(()=>[i(p,{label:"文件名称","has-feedback":"",name:"name",rules:[{required:!0,message:"请输入文件名称",trigger:"blur"}]},{default:a(()=>[i(U,{value:o.name,"onUpdate:value":l[2]||(l[2]=e=>o.name=e),placeholder:"文件名称"},null,8,["value"])]),_:1}),i(p,{label:"图片预览"},{default:a(()=>[r("img",{src:o.path,style:{height:"100px","border-radius":"5px"}},null,8,O)]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"]),i(N,{columns:t.columns,baseURL:"/api/images",ref_key:"gvbTable",ref:d,"page-size":7,"like-title":"搜索图片昵称","default-delete":""},{add:a(()=>[i(u,{type:"primary",onClick:l[4]||(l[4]=e=>t.visible=!0)},{default:a(()=>[k("上传图片")]),_:1})]),edit:a(({record:e})=>[i(u,{type:"primary",onClick:c=>V(e)},{default:a(()=>[k("编辑")]),_:2},1032,["onClick"])]),cell:a(({column:e,record:c})=>[e.key==="path"?(g(),v("img",{key:0,src:c.path,style:{height:"60px","border-radius":"5px"}},null,8,S)):E("",!0)]),_:1},8,["columns"])])}}};export{D as default};
