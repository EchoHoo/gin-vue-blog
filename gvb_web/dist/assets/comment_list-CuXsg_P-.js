import{_ as D}from"./gvb_table-G_plVNMz.js";import{a as U,c as k,r as A,d as _,f as l,w as n,g as r,h as o,o as s,i as u,l as p,F as B,k as E}from"./index-Csyz-WVi.js";import{f as N}from"./article_api-V3HofU-P.js";import{c as V,a as q}from"./comment_api-Cm0tKtln.js";import"./data-DE6nU9bg.js";const F=["src"],J={__name:"comment_list",setup($){U();const c=k(null),f=k(null),e=A({list:[],columns:[{title:"id",dataIndex:"id",key:"id"},{title:"文章标题",dataIndex:"article_title",key:"article_title"},{title:"文章封面",dataIndex:"article_banner",key:"article_banner"},{title:"父评论id",dataIndex:"parent_comment_id",key:"parent_comment_id"},{title:"评论内容",dataIndex:"content",key:"content"},{title:"点赞数",dataIndex:"digg_count",key:"digg_count"},{title:"评论数",dataIndex:"comment_count",key:"comment_count"},{title:"评论人昵称",dataIndex:"user_nick_name",key:"user_nick_name"},{title:"评论时间",dataIndex:"created_at",key:"created_at"},{title:"操作",dataIndex:"action",key:"action"}],visible:!1,state:{article_id:null,content:"",parent_comment_id:null},articleIDTitleList:[]});async function v(i){let t=await q(i.id);if(t.code){r.error(t.msg);return}r.success(t.msg),c.value.ExportList()}function g(){y(),e.visible=!0}async function y(){let i=await N();e.articleIDTitleList=i.data}async function x(){try{await f.value.validate()}catch{return}let i=await V(e.state);if(i.code){r.error(i.msg);return}r.success(i.msg),e.state.content="",e.visible=!1,c.value.ExportList()}return(i,t)=>{const I=o("a-select"),d=o("a-form-item"),w=o("a-textarea"),h=o("a-input-number"),C=o("a-form"),R=o("a-modal"),b=o("a-button"),T=o("a-tag"),L=o("a-popconfirm");return s(),_("div",null,[l(R,{title:"发布评论",open:e.visible,"onUpdate:open":t[3]||(t[3]=a=>e.visible=a),onOk:x},{default:n(()=>[l(C,{model:e.state,name:"basic",ref_key:"formRef",ref:f,"label-col":{span:4},"wrapper-col":{span:20},autocomplete:"off"},{default:n(()=>[l(d,{label:"文章",name:"article_id","has-feedback":"",rules:[{required:!0,message:"请选择文章",trigger:"blur"}]},{default:n(()=>[l(I,{class:"gvb_select",value:e.state.article_id,"onUpdate:value":t[0]||(t[0]=a=>e.state.article_id=a),style:{width:"200px"},allowClear:"",options:e.articleIDTitleList,placeholder:"选择文章"},null,8,["value","options"])]),_:1}),l(d,{label:"评论内容",name:"content","has-feedback":"",rules:[{required:!0,message:"请输入评论内容",trigger:"blur"}]},{default:n(()=>[l(w,{placeholder:"评论内容",value:e.state.content,"onUpdate:value":t[1]||(t[1]=a=>e.state.content=a),class:"user_ipt","auto-size":{minRows:2,maxRows:5}},null,8,["value"])]),_:1}),l(d,{label:"父评论id",name:"parent_comment_id","has-feedback":""},{default:n(()=>[l(h,{placeholder:"父评论id",value:e.state.parent_comment_id,"onUpdate:value":t[2]||(t[2]=a=>e.state.parent_comment_id=a)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open"]),l(D,{columns:e.columns,baseURL:"/api/comments_all","like-title":"搜索评论内容","is-batch-delete":!1,ref_key:"gvbTable",ref:c,"is-edit":!1,"is-select":!1,"default-delete":""},{add:n(()=>[l(b,{type:"primary",onClick:g},{default:n(()=>[u("添加")]),_:1})]),edit:n(({record:a})=>[]),cell:n(({column:a,record:m,index:z})=>[a.key==="article_banner"?(s(),_("img",{key:0,src:m.article_banner,alt:"",height:"60",style:{"border-radius":"5px"}},null,8,F)):p("",!0),a.key==="parent_comment_id"?(s(),_(B,{key:1},[m.parent_comment_id===null?(s(),E(T,{key:0,color:"red"},{default:n(()=>[u(" 根评论 ")]),_:1})):p("",!0)],64)):p("",!0)]),delete:n(({record:a})=>[l(L,{title:"是否确定删除?","ok-text":"删除","cancel-text":"取消",onConfirm:m=>v(a)},{default:n(()=>[l(b,{class:"gvb_table_action delete",type:"danger"},{default:n(()=>[u("删除")]),_:1})]),_:2},1032,["onConfirm"])]),_:1},8,["columns"])])}}};export{J as default};
