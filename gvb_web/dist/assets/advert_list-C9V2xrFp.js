import{_ as S}from"./gvb_table-FccGUr9I.js";import{S as A,c as k,r as v,d as g,f as a,w as s,g as x,h as o,o as i,s as T,e as I,i as m,l as y,F as U,k as C,t as D}from"./index-DhileAJB.js";import"./data-DE6nU9bg.js";function E(p){return A.post("/api/adverts",p)}function F(p,f){return A.put("/api/adverts/"+p,f)}const M=["src"],P=["src"],H={__name:"advert_list",setup(p){const f=k(null),B=k(null),u=k(0),b=v({href:"",title:"",images:"",is_show:!0}),e=v({href:"",title:"",images:"",is_show:!0}),n=v({columns:[{title:"id",key:"id",dataIndex:"id"},{title:"广告标题",key:"title",dataIndex:"title"},{title:"图片路径",key:"images",dataIndex:"images"},{title:"跳转地址",key:"href",dataIndex:"href"},{title:"是否显示",key:"is_show",dataIndex:"is_show"},{title:"添加时间",key:"created_at",dataIndex:"created_at"},{title:"操作",key:"action",dataIndex:"action"}],open:!1});function N(){n.open=!0,u.value=0,Object.assign(e,b)}function O(l){u.value=l.id,e.title=l.title,e.href=l.href,e.images=l.images,e.is_show=l.is_show,n.open=!0}async function R(){let l;if(u?l=await F(u.value,e):l=await E(e),l.code===200){x.error(l.message);return}x.success(l.message),n.open=!1,Object.assign(e,b),f.value.ExportList()}let V=async(l,r)=>{try{return new URL(r),Promise.resolve()}catch{return Promise.reject("请输入正确的链接")}};return(l,r)=>{const _=o("a-input"),d=o("a-form-item"),j=o("a-switch"),q=o("a-form"),L=o("a-modal"),h=o("a-button"),w=o("a-tag");return i(),g("div",null,[a(L,{title:u.value?"编辑广告":"添加广告",open:n.open,"onUpdate:open":r[4]||(r[4]=t=>n.open=t),onOk:R},{default:s(()=>[a(q,{model:e,name:"basic","label-col":{span:4},"wrapper-col":{span:16},ref_key:"formRef",ref:B,autocomplete:"off"},{default:s(()=>[a(d,{label:"广告名称","has-feedback":"",name:"title",rules:[{required:!0,message:"请输入广告名称",trigger:"blur"}]},{default:s(()=>[a(_,{value:e.title,"onUpdate:value":r[0]||(r[0]=t=>e.title=t),placeholder:"广告名称"},null,8,["value"])]),_:1}),a(d,{label:"广告链接","has-feedback":"",name:"href",rules:[{required:!0,message:"请输入广告链接",trigger:"blur"},{validator:T(V),message:"请输入正确的链接",trigger:"blur"}]},{default:s(()=>[a(_,{value:e.href,"onUpdate:value":r[1]||(r[1]=t=>e.href=t),placeholder:"广告链接"},null,8,["value"])]),_:1},8,["rules"]),a(d,{label:"图片地址","has-feedback":"",name:"images",rules:[{required:!0,message:"请输入图片地址",trigger:"blur"}]},{default:s(()=>[a(_,{value:e.images,"onUpdate:value":r[2]||(r[2]=t=>e.images=t),placeholder:"图片地址"},null,8,["value"])]),_:1}),a(d,{label:"是否显示",name:"is_show"},{default:s(()=>[a(j,{checked:e.is_show,"onUpdate:checked":r[3]||(r[3]=t=>e.is_show=t)},null,8,["checked"])]),_:1}),a(d,{label:"图片预览"},{default:s(()=>[I("img",{src:e.images,height:"120px",width:"160px",style:{"border-radius":"5px"},alt:""},null,8,M)]),_:1})]),_:1},8,["model"])]),_:1},8,["title","open"]),a(S,{columns:n.columns,baseURL:"/api/adverts",ref_key:"gvbTable",ref:f,"page-size":7,"like-title":"搜索广告昵称","default-delete":""},{add:s(()=>[a(h,{type:"primary",onClick:N},{default:s(()=>[m("添加广告")]),_:1})]),edit:s(({record:t})=>[a(h,{type:"primary",onClick:c=>O(t)},{default:s(()=>[m("编辑")]),_:2},1032,["onClick"])]),cell:s(({column:t,record:c})=>[t.key==="images"?(i(),g("img",{key:0,src:c.images,style:{height:"60px","border-radius":"5px"}},null,8,P)):y("",!0),t.key==="is_show"?(i(),g(U,{key:1},[c.is_show?(i(),C(w,{key:0,color:"green"},{default:s(()=>[m("显示")]),_:1})):(i(),C(w,{key:1,color:"red"},{default:s(()=>[m("不显示")]),_:1}))],64)):y("",!0),t.key==="href"?(i(),g(U,{key:2},[I("span",null,D(c.href),1),a(h,{type:"link",target:"_blank",href:c.href},{default:s(()=>[m("访问")]),_:2},1032,["href"])],64)):y("",!0)]),_:1},8,["columns"])])}}};export{H as default};
