import{E as y}from"./MdEditor-D9LfNZMK.js";/* empty css              */import{u as k}from"./image_api-CXsxezfy.js";import{h as U}from"./article_api-Dh3ZF_NR.js";import{b as A,a as E,c as O,r as m,x as S,d as V,f as d,s as h,g as f,o as x}from"./index-CMDvGcfm.js";import{_ as I}from"./gvb_article_model-B8VTg7x0.js";import"./index-Dd01TaHI.js";import"./tag_api-C7P-Rzx2.js";const T={__name:"add_article",setup(L){const p=A(),v=E(),r=O(!1),g=async(t,e)=>{const u=(await Promise.all(t.map(n=>k(n)))).map(n=>{const l=n.data;if(Array.isArray(l)&&l.length>0){let s=l[0].file_name;return s?s.startsWith("/")?s:"/"+s:""}return""}).filter(n=>n!=="");console.log("Final file URLs:",u),e(u)},_=m({content:"",title:"",abstract:"",banner_id:0,category:"",tags:[],link:"",source:""}),a=m({content:"",title:"",abstract:"",banner_id:0,category:"",tags:[],link:"",source:""});function i(t){t.ctrlKey&&t.key==="s"&&(c(),t.preventDefault())}function c(){r.value=!0}window.addEventListener("keydown",i),S(()=>{window.removeEventListener("keydown",i)});const b=(t,e)=>{c()};async function w(t){Object.assign(a,t),console.log(a),console.log(t);let e=await U(a);if(e.code){f.error(e.msg);return}f.success(e.msg),r.value=!1,Object.assign(a,_),v.push({name:"article_list"}),p.removeTab({name:"add_article"})}return(t,e)=>(x(),V("div",null,[d(I,{visible:r.value,"onUpdate:visible":e[0]||(e[0]=o=>r.value=o),onOk:w},null,8,["visible"]),d(h(y),{modelValue:a.content,"onUpdate:modelValue":e[1]||(e[1]=o=>a.content=o),onOnUploadImg:g,onOnSave:b},null,8,["modelValue"])]))}};export{T as default};
