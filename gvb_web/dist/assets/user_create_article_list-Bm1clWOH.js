import{_ as F}from"./gvb_table-BXq38T5W.js";import{a as H}from"./tag_api-C7P-Rzx2.js";import{d as R,u as S}from"./article_api-Dh3ZF_NR.js";import{a as q,b as j,c as k,r as V,d as l,k as f,l as o,f as g,w as r,g as A,o as i,s as z,i as c,t as u,e as d,F as G,q as J,h as v}from"./index-CMDvGcfm.js";import{_ as K}from"./gvb_article_model-B8VTg7x0.js";import{i as P}from"./image_api-CXsxezfy.js";import"./data-DE6nU9bg.js";/* empty css              */const Q={key:0},W=["innerHTML"],X=["src"],Y={key:3,class:"gvb_article_data"},Z=d("i",{class:"fa fa-eye"},null,-1),tt=d("i",{class:"fa fa-thumbs-o-up"},null,-1),et=d("i",{class:"fa fa-comment-o"},null,-1),at=d("i",{class:"fa fa-star-o"},null,-1),st={key:4,class:"gvb_article_abstract"},it={key:5,class:"gvb_article_tags"},gt={__name:"user_create_article_list",setup(nt){const h=q(),y=j(),m=k(null),b=k(null),x=k(null),e=V({list:[{abstract:"",banner_id:3,banner_url:"",category:"p1",collects_count:0,comment_count:0,created_at:"",digg_count:0,id:"",look_count:0,tags:[],title:"",updated_at:"",user_avatar:"",user_id:1,user_nick_name:""}],columns:[{title:"id",dataIndex:"id",key:"id"},{title:"文章标题",dataIndex:"title",key:"title"},{title:"文章分类",dataIndex:"category",key:"category"},{title:"文章简介",dataIndex:"abstract",key:"abstract"},{title:"作者",dataIndex:"user_nick_name",key:"user_nick_name"},{title:"封面",dataIndex:"banner_url",key:"banner_url"},{title:"文章数据",dataIndex:"data",key:"data"},{title:"标签",dataIndex:"tags",key:"tags"},{title:"发布时间",dataIndex:"created_at",key:"created_at"},{title:"操作",dataIndex:"action",key:"action"}],editVisible:!1,state:{title:"",abstract:"",banner_id:0,category:"",tags:[],link:"",source:""},editID:""}),_=V({tagOptions:[],categoryOptions:[],bannerOptions:[]}),L=["red","blue","green","purple","cyan","orange","pink"];function T(t){return L[t]}function C(){x.value.ExportList({tag:m.value,key:b.value})}async function I(){let t=await H();_.tagOptions=t.data;let s=await R();_.categoryOptions=s.data;let p=await P();_.bannerOptions=p.data}async function D(){await h.push({name:"add_article"}),y.addTab({name:"add_article",title:"添加文章"})}function N(t){e.state.title=t.title,e.state.abstract=t.abstract,e.state.banner_id=t.banner_id,e.state.category=t.category,e.state.tags=t.tags,e.state.link=t.link,e.state.source=t.source,e.editID=t.id,e.editVisible=!0}function B(t){h.push({name:"edit_article",params:{id:t.id}}),y.addTab({name:"edit_article",title:"编辑文章"})}async function E(t){let s=await S(e.editID,t);if(s.code){A.error(s.msg);return}A.success(s.msg),e.editVisible=!1,I()}return I(),(t,s)=>{const p=v("a-button"),M=v("a-tag"),w=v("a-select");return i(),l("div",null,[e.editVisible?(i(),f(K,{key:0,visible:e.editVisible,"onUpdate:visible":s[0]||(s[0]=a=>e.editVisible=a),onOk:E,state:e.state,"is-edit":"","init-data-state":_},null,8,["visible","state","init-data-state"])):o("",!0),g(F,{columns:e.columns,baseURL:"/api/articles?is_user=true","like-title":"搜索文章标题",ref_key:"gvbTable",ref:x,"default-delete":""},{add:r(()=>[z(y).userInfo.role!==2?(i(),f(p,{key:0,type:"primary",onClick:D},{default:r(()=>[c("添加")]),_:1})):o("",!0)]),edit:r(({record:a})=>[g(p,{type:"primary",onClick:n=>N(a)},{default:r(()=>[c("编辑")]),_:2},1032,["onClick"]),g(p,{type:"primary",onClick:n=>B(a)},{default:r(()=>[c("正文编辑")]),_:2},1032,["onClick"])]),cell:r(({column:a,record:n,index:U})=>[a.key==="index"?(i(),l("span",Q,u(U+1),1)):o("",!0),a.key==="title"?(i(),l("span",{key:1,class:"gvb_article_title",innerHTML:n.title},null,8,W)):o("",!0),a.key==="banner_url"?(i(),l("img",{key:2,src:n.banner_url,alt:"",height:"60",style:{"border-radius":"5px"}},null,8,X)):o("",!0),a.key==="data"?(i(),l("div",Y,[d("span",null,[Z,c(u(n.look_count),1)]),d("span",null,[tt,c(u(n.digg_count),1)]),d("span",null,[et,c(u(n.comment_count),1)]),d("span",null,[at,c(u(n.collects_count),1)])])):o("",!0),a.key==="abstract"?(i(),l("span",st,u(n.abstract),1)):o("",!0),a.key==="tags"?(i(),l("div",it,[(i(!0),l(G,null,J(n.tags,($,O)=>(i(),f(M,{color:T(O),key:O},{default:r(()=>[c(u($),1)]),_:2},1032,["color"]))),128))])):o("",!0)]),filters:r(()=>[g(w,{class:"gvb_select",value:m.value,"onUpdate:value":s[1]||(s[1]=a=>m.value=a),style:{width:"200px"},allowClear:"",onChange:C,options:_.tagOptions,placeholder:"筛选文章标签"},null,8,["value","options"]),g(w,{class:"gvb_select",value:b.value,"onUpdate:value":s[2]||(s[2]=a=>b.value=a),style:{width:"200px"},allowClear:"",onChange:C,options:_.categoryOptions,placeholder:"筛选文章分类"},null,8,["value","options"])]),_:1},8,["columns"])])}}};export{gt as default};
