import{c as d,y as v,v as g,o as _,k as S,s as y,g as u,u as k,a as A,b as w,d as R,f as U}from"./index-Sy54AUqK.js";import{E as V}from"./MdEditor-Co7qFvn8.js";/* empty css              */import{u as b}from"./image_api-CdPAa1or.js";import{i as x,u as B}from"./article_api-BZl38PjZ.js";import"./index-CYFOkxZD.js";const E={__name:"gvb_editor",props:{content:{type:String}},emits:["update:content","onSave"],setup(f,{emit:c}){const o=f,t=d(""),n=d(null);function m(){t.value=o.content}m();const i=c;v(t,()=>{i("update:content",t.value)}),v(()=>o.content,()=>{t.value=o.content},{immediate:!0});const a=async(e,r)=>{const p=await Promise.all(e.map(s=>b(s)));r(p.map(s=>{if(s.code){u.error(s.msg);return}return u.success("上传成功"),s.data}))},l=(e,r)=>{i("onSave",e)};return g(()=>{var e;(e=n.value)==null||e.focus()}),(e,r)=>(_(),S(y(V),{ref_key:"editorRef",ref:n,modelValue:t.value,"onUpdate:modelValue":r[0]||(r[0]=p=>t.value=p),onOnUploadImg:a,onOnSave:l},null,8,["modelValue"]))}},N={__name:"edit_article",setup(f){const c=k(),o=A(),t=w(),n=d("");async function m(){let a=await x(c.params.id);n.value=a.data}m();async function i(){if(n.value.trim()===""){u.error("文章内容不能为空");return}let a=await B(c.params.id,{content:n.value});if(a.code){u.error(a.msg);return}u.success(a.msg),o.push({name:"article_list"}),t.removeTab({name:"edit_article"})}return(a,l)=>(_(),R("div",null,[U(E,{content:n.value,"onUpdate:content":l[0]||(l[0]=e=>n.value=e),onOnSave:i},null,8,["content"])]))}};export{N as default};
